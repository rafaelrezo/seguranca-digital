# Planejamento de um Engajamento de Teste de Intrusão

Esta seção apresenta, de forma didática e aplicada, todos os elementos necessários para realizar o planejamento adequado de um teste de intrusão.  
O planejamento é a base de qualquer engajamento profissional, garantindo que o teste ocorra de maneira segura, ética, autorizada e alinhada com os objetivos do cliente.

---

# 1. Importância do Planejamento

O planejamento é a etapa que estabelece:

- o alinhamento entre cliente e equipe de teste,  
- os objetivos claros do trabalho,  
- os limites técnicos e legais,  
- e a organização do processo como um todo.

Sem um bom planejamento, há riscos de conflitos, interrupções operacionais, danos não intencionais e até infrações legais.

### Analogia para profissionais de TI

É como iniciar um grande *deploy* em produção: antes de executar qualquer ação, você define janelas de manutenção, planos de rollback, responsáveis e limites do que pode ser modificado.

### Analogia para automação industrial

É semelhante à preparação de uma parada programada em uma planta — antes de encostar em qualquer CLP, é preciso definir exatamente o que será mexido, quem autoriza e quais setores podem ou não ser afetados.

---

# 2. Definição do Escopo

A definição do escopo é um dos pontos mais críticos.  
O escopo determina:

- o que **pode** ser testado,  
- o que **não pode** ser testado,  
- e quais sistemas, redes ou aplicações estarão dentro do trabalho.

Um escopo bem definido evita incidentes acidentais e conflitos.

### Exemplos

- Um pentest pode autorizar testar apenas um portal web publicado na internet, excluindo inteiramente os servidores de e-mail.  
- Em uma indústria, pode ser permitido testar apenas a rede corporativa e proibir qualquer interação direta com ambientes OT sensíveis.

---

# 3. Requisitos Legais e Regulatórios

Diferentes setores e países possuem legislações próprias que regulam testes de intrusão.  
Isso inclui leis de proteção de dados, obrigações contratuais e limitações específicas.

### Exemplo

- Em ambientes de saúde nos EUA, o teste deve obedecer às restrições de privacidade previstas em leis equivalentes à HIPAA.  
- No Brasil, é preciso considerar requisitos da LGPD, contratos internos e políticas de segurança da informação.

### Analogia para TI e automação

Da mesma forma que não se pode alterar um sistema crítico sem seguir normas internas de compliance, um pentest não pode violar exigências legais nem expor dados sensíveis.

---

# 4. Regras de Engajamento (RoE)

As *Rules of Engagement* estabelecem o que pode ser feito, quando e de que forma o teste deve ocorrer.

As regras podem definir:

- técnicas proibidas (como negação de serviço),  
- horários permitidos para os testes,  
- limites de agressividade,  
- métodos de validação,  
- e o que fazer em caso de impacto inesperado.

### Exemplos

- O cliente pode proibir ataques que causem interrupção, como DDoS.  
- O teste pode ser autorizado apenas fora do horário comercial.  

### Analogia para automação industrial

É como um engenheiro liberar apenas *testes offline* em um equipamento e restringir testes online porque isso poderia causar falhas reais no processo.

---

# 5. Acordo de Confidencialidade (NDA)

O NDA (Non-Disclosure Agreement) garante que qualquer informação sensível acessada durante o pentest seja protegida.

### Importância

- Evita que vulnerabilidades internas sejam expostas.  
- Garante proteção jurídica para ambas as partes.  
- Reforça a ética do processo.

### Exemplo

Se o pentester descobre um servidor legado, vulnerável e ainda essencial para o processo do cliente, ele não pode repassar essa informação a terceiros.

---

# 6. Statement of Work (SOW)

O Statement of Work descreve, de forma detalhada:

- atividades a serem realizadas,  
- entregáveis,  
- prazos,  
- etapas intermediárias,  
- responsabilidades,  
- e condições de pagamento.

### Exemplo típico

Um SOW pode definir:

- realização de varreduras,  
- tentativas de exploração,  
- análise de riscos,  
- entrega de relatório final em quatro semanas.

### Analogia para profissionais de TI

É o equivalente a um documento de especificação de sprint, onde estão descritos todos os entregáveis combinados.

### Analogia industrial

É como o plano de manutenção de um equipamento, detalhando cada etapa prevista e o tempo estimado.

---

# 7. Canais de Comunicação e Caminhos de Escalonamento

Em qualquer pentest profissional, é essencial ter:

- pontos de contato definidos,  
- caminhos de escalonamento em caso de incidente,  
- canais para alertar sobre descobertas críticas.

Isso evita atrasos e permite respostas rápidas.

### Exemplo

Se o pentester identifica uma vulnerabilidade que pode resultar em perda imediata de dados, ele precisa saber exatamente quem deve ser acionado sem gerar pânico ou interrupção indevida.

---

# 8. Tolerância ao Risco e Impacto no Negócio

Cada organização tem um nível diferente de tolerância ao risco.

O planejamento deve identificar:

- até onde o cliente permite que o teste avance,  
- quais impactos são aceitáveis,  
- que tipos de interrupção devem ser evitadas.

### Exemplos

- Um banco pode permitir testes agressivos em ambientes controlados, mas não em sistemas de transações.  
- Uma indústria pode permitir avaliação passiva da rede OT, mas não testes ativos em CLPs operando bombas ou válvulas.

### Analogia

É como escolher testar apenas uma parte da linha de produção para evitar parar toda a planta.

---

# 9. Resumo Geral

O planejamento de um engajamento envolve:

- definição clara de escopo,  
- entendimento das restrições legais,  
- estabelecimento das regras de engajamento,  
- assinatura de NDA,  
- criação do Statement of Work,  
- definição dos canais de comunicação,  
- e alinhamento da tolerância ao risco do cliente.

Com esses elementos bem definidos, o pentest ocorre de maneira profissional, segura e eficiente.

---

