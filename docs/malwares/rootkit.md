# Seção: Rootkits

> **Objetivo da seção:** compreender o que são rootkits, como funcionam, suas técnicas de ocultação, o impacto no sistema e como detectar esse tipo avançado de ameaça.

---

## 1. O que é um rootkit
- **Definição:** software mal-intencionado projetado para obter **controle de nível administrativo (root)** em um sistema **sem ser detectado**.  
- Permite ao invasor executar qualquer ação no sistema: instalar programas, abrir portas, excluir dados ou manipular recursos críticos.  
- Em **Windows**, equivale ao nível **Administrador**; em **Linux/Unix/MacOS**, equivale ao nível **root**.  

> Para um invasor, é o maior nível de privilégio possível. Para a vítima, representa perda quase total de controle.

---

## 2. Estrutura de permissões (anéis de proteção)
- **Anel 3:** nível do usuário comum, menor privilégio.  
- **Anel 1:** nível administrativo (Administrador/Root).  
- **Anel 0:** modo **Kernel** — maior privilégio, com acesso direto a drivers e recursos de hardware.  

> **Rootkits buscam operar no Anel 0**, onde podem se ocultar e manipular o sistema em nível profundo.

---

## 3. Como os rootkits funcionam
1. O atacante instala o rootkit em um sistema comprometido.  
2. O rootkit busca elevar privilégios — do nível de usuário (Anel 3) até o nível de kernel (Anel 0).  
3. Uma vez no kernel, consegue:  
   - ocultar sua própria presença,  
   - manipular processos do sistema,  
   - executar atividades maliciosas sem o conhecimento do usuário ou até do próprio SO.  

---

## 4. Técnicas usadas por rootkits
### 4.1 Injeção de DLL
- Rootkit injeta código malicioso dentro de **bibliotecas dinâmicas (DLLs)** carregadas pelo Windows.  
- Esse código é executado sempre que a DLL é chamada, tornando o rootkit invisível ao sistema.  

### 4.2 Uso de *shims*
- Um **shim** é um código intermediário entre dois componentes de software.  
- O rootkit intercepta chamadas entre o SO e a DLL e as redireciona para código malicioso.  
- Isso permite esconder suas atividades e enganar mecanismos de segurança.

---

## 5. Por que rootkits são perigosos
- **Dificuldade de detecção:** antivírus tradicionais não conseguem enxergar rootkits no kernel.  
- **Persistência:** podem sobreviver a reinicializações e se manter ocultos por longos períodos.  
- **Capacidade de controle total:** permitem que o invasor tenha privilégios equivalentes ao próprio sistema operacional.  

---

## 6. Detecção e remoção
- **Método tradicional:** ineficaz; antivírus comuns raramente detectam rootkits.  
- **Método recomendado:**  
  - Inicializar a máquina a partir de um **dispositivo externo** (ex.: Live CD Linux).  
  - Realizar uma varredura completa na unidade interna (HD ou SSD).  
- **Motivo:** como o rootkit está ativo no kernel, só é possível identificá-lo analisando o sistema “de fora”.

---

## 7. Conclusão
- **Rootkits = software malicioso invisível em nível administrativo/kernel.**  
- Buscam acesso ao **Anel 0**, o nível mais privilegiado do sistema.  
- Usam técnicas como **injeção de DLL** e **shims** para se ocultar.  
- São difíceis de detectar, pois exploram a confiança interna do sistema operacional.  
- **Melhor defesa:** vigilância contínua, boas práticas de segurança e varreduras externas em caso de suspeita.

