# Seção: Malware — Introdução

> **Objetivo da seção:** introduzir o que é malware, seus tipos principais, diferença entre vetor de ameaça e vetor de ataque, indicadores de infecção e medidas básicas de mitigação — com exemplos aplicados a ambientes de Engenharia de Controle e Automação.

---

## 1. O que é malware
**Malware** (software mal-intencionado) é qualquer software projetado para infiltrar-se, danificar, interromper ou obter dados de um sistema sem o conhecimento ou consentimento do usuário.  
Inclui vírus, worms, trojans, ransomware, spyware, rootkits, botnets, keyloggers, backdoors, entre outros.

> **Analogia:** imagine que o atacante quer levar um *cupcake* da casa dele até a mesa da sua cozinha — o cupcake = malware; a rua/comunidade vulnerável = vetor de ameaça; a ação de abrir a porta/entrar = vetor de ataque.

---

## 2. Vetor de ameaça vs. vetor de ataque
- **Vetor de ameaça:** condição ou estado que facilita a infiltração.  
  *Ex.:* software sem patch, rede sem segmentação, contas com senha fraca, pendrives não controlados.  
  *Exemplo (automação):* uma estação de engenharia desatualizada na mesma VLAN do SCADA.

- **Vetor de ataque:** sequência de ações ou método usado para explorar a vulnerabilidade.  
  *Ex.:* exploit remoto, phishing, execução de código via mídia removível.  
  *Exemplo (automação):* alguém conecta um pendrive com script malicioso que altera parâmetros da PLC.

---

## 3. Tipos principais de malware
### 3.1 Vírus
- Anexa-se a arquivos legítimos e se propaga quando esses arquivos são executados.  
  *Ex.:* um script de configuração infectado que corrompe projetos HMI.

### 3.2 Worms
- Programas autônomos que se replicam e se espalham pela rede explorando vulnerabilidades.  
  *Ex.:* worm que explora SMB e se propaga entre estações de engenharia.

### 3.3 Trojans (Cavalos de Troia)
- Software disfarçado de legítimo; ao executar, concede acesso ao invasor (RATs são uma forma comum).  
  *Ex.:* utilitário de configuração que instala um acesso remoto.

### 3.4 Ransomware
- Criptografa dados e exige pagamento pelo desencriptador.  
  *Ex.:* ransomware que cifra recipes de processo e bloqueia a planta.

### 3.5 Botnets / Zumbis
- Máquinas comprometidas controladas remotamente, usadas para DDoS, spam ou mineração.  
  *Ex.:* PCs de engenharia usados para mineração, afetando a rede OT.

### 3.6 Rootkits
- Ferramentas que ocultam presença e atividades, permitindo persistência privilegiada.  
  *Ex.:* rootkit em servidor de historian que esconde exfiltração de dados.

### 3.7 Backdoors e Bombas Lógicas
- **Backdoor:** meio de contornar autenticação normal.  
- **Bomba lógica:** código que aciona ação maliciosa quando uma condição é atendida.  
  *Ex.:* atualização de firmware com backdoor; lógica que desliga um atuador ao atingir determinada condição.

### 3.8 Keyloggers, Spyware e Bloatware
- **Keylogger/Spyware:** coleta de credenciais e atividades.  
- **Bloatware:** software desnecessário que consome recursos e pode esconder risco.  
  *Ex.:* ferramenta de diagnóstico que exfiltra credenciais do operador.

---

## 4. Técnicas modernas de infecção e evasão
- **Fileless malware:** execução na memória usando ferramentas legítimas (PowerShell, WMI).  
- **Múltiplos estágios / ofuscação:** downloader → stager → payload.  
- **Living-off-the-land:** uso de utilitários do sistema para ações maliciosas.  
- **Especificidades OT:** abuso de protocolos industriais (Modbus, OPC) para enviar comandos anômalos.

---

## 5. Vetores comuns em ambientes de automação
- Estações de engenharia e HMIs sem atualização.  
- Mídia removível sem política de uso.  
- Atualizações de firmware sem assinatura verificada.  
- Acesso remoto mal configurado (RDP/VPN sem MFA).  
- IT e OT na mesma VLAN.  
- Phishing e credenciais comprometidas.  
- Dispositivos IoT/RTUs vulneráveis.

---

## 6. Indicadores de comprometimento
- **Contas:** bloqueios, tentativas repetidas, sessões simultâneas.  
- **Performance:** picos de CPU/I/O, processos desconhecidos.  
- **Logs:** ausentes, truncados, fora de ordem.  
- **Disponibilidade:** serviços HMI/SCADA inacessíveis.  
- **Rede:** conexões externas inesperadas, tráfego anômalo em portas industriais.  
- **OT específico:** alteração de setpoints, receitas modificadas sem autorização.

---

## 7. Mitigações e boas práticas
- **Inventário e patches:** lista atualizada de ativos, aplicação de patches, compensações quando não for possível.  
- **Segmentação:** zones and conduits, firewalls industriais, VLANs separadas.  
- **Monitoramento:** EDR/OT-aware, IDS/IPS com regras industriais.  
- **Mídia removível:** bloqueio e registro de uso, apenas mídias aprovadas.  
- **Autenticação:** MFA, separação de contas de engenharia e operação.  
- **Cadeia de fornecimento:** verificação de assinaturas e hashes de firmware/updates.  
- **Backups:** cópias offline de projetos/receitas; testes regulares de restauração.  
- **Fornecedores:** acesso remoto por jump hosts, sessões gravadas, privilégios mínimos.

---

## 8. Checklist rápido
- Inventário atualizado?  
- Patches críticos aplicados/documentados?  
- Segmentação IT/OT efetiva?  
- Mídia removível controlada?  
- MFA habilitado para acessos críticos?  
- Backups offline recentes e testados?  
- Monitoramento e alertas configurados?  
- Plano de resposta definido?

---

## 9. Exemplos ilustrativos
- **WannaCry:** vulnerabilidade sem patch (MS17-010) → exploit → encriptação → paralisação.  
- **Firmware comprometido:** update sem assinatura instala backdoor em RTU.  
- **Mídia removível:** pendrive altera temporizadores da PLC sem controle.

---

## 10. Conclusão
Esta seção fornece uma visão geral sobre malware aplicado a controle e automação.  
O entendimento de tipos, vetores de infecção, indicadores de ataque e mitigação é essencial para proteger sistemas OT, sempre relacionando teoria com exemplos práticos de laboratório ou planta real.
